(

 (('take  0 'from _         ) => ())
 (('take #n 'from (?x . ?xs)) => `(,x . ,^(take ,(- n 1) from ,xs)))

 (('drop  0 'from ?xs       ) => xs)
 (('drop #n 'from (?x . ?xs)) => ^(drop ,(- n 1) from ,xs))

 (('nth  _ 'in ()        ) => 'OUT-OF-BOUND)
 (('nth  0 'in (?x .   _)) => x)
 (('nth #n 'in (_  . ?xs)) => ^(nth ,(- n 1) in ,xs))

 (('index-of  _ 'in ()        ) => 'NOT-FOUND)
 (('index-of ?x 'in (?x .   _)) => 0)
 (('index-of ?x 'in ( _ . ?xs)) => ^(io-succ-or-not ,^(index-of ,x in ,xs)))
 (('io-succ-or-not 'NOT-FOUND) => 'NOT-FOUND) ;(not too pretty...)
 (('io-succ-or-not #n        ) => (+ 1 n)) ;(maybe it's better to let it fail?)

 (('length ()       ) => 0)
 (('length (_ . ?xs)) => (+ 1 ^(length ,xs)))

 (('append ()         ?ys) => ys)
 (('append (?x . ?xs) ?ys) => `(,x . ,^(append ,xs ,ys)))

 (('append-map ?p ()        ) => ())
 (('append-map ?p (?x . ?xs)) => ^(append ,^(,p ,x) ,^(append-map ,p ,xs)))


 (('lookup    _ 'in ()                    ) => 'NOT-FOUND)
 (('lookup ?key 'in ((?key ?val) .      _)) => val)
 (('lookup ?key 'in (          _ . ?alist)) => ^(lookup ,key in ,alist))


 (('member?  _ ()        ) => 'NO)
 (('member? ?x (?x . _  )) => 'YES)
 (('member? ?x ( _ . ?xs)) => ^(member? ,x ,xs))

 (('uniq ()) => ())
 (('uniq (?x . ?xs)) => ^(uniq* ,x ,^(member? ,x ,xs) ,xs))
 (('uniq*  _ 'YES ?xs) => ^(uniq ,xs))
 (('uniq* ?x 'NO  ?xs) => `(,x . ,^(uniq ,xs)))

 (('union ?xs ?ys) ^(uniq ,^(append ,xs ,ys)))

 (('intersection () _ ) => ())
 (('intersection _  ()) => ())
 (('intersection (?x . ?xs) ?ys) => ^(intersection* ,^(member? ,x ,ys) ,x ,xs ,ys))
 (('intersection* 'YES ?x ?xs ?ys) => `(,x . ,^(intersection ,xs ,ys)))
 (('intersection* 'NO   _ ?xs ?ys) => ^(intersection ,xs ,ys))

 ;(- hmmm sure? -)
 (('filter-map ?F   _ ()        ) => ())
 (('filter-map ?F ?op (?x . ?xs)) => ^(filter-map* ,F ,^(,op ,x) ,op ,xs))
 (('filter-map* ?F ?F ?op ?xs) => ^(filter-map ,F ,op ,xs))
 (('filter-map* ?F ?e ?op ?xs) => `(,e . ,^(filter-map ,F ,op ,xs)))

 (('partition ?p ?xs) => ^(partition* ,p ,xs () ()))
 (('partition* ?p ()         ?yes ?nos) => `(,yes ,nos))
 (('partition* ?p (?x . ?xs) ?yes ?nos) => ^(partition** ,^(,p ,x) ,p ,x ,xs ,yes ,nos))
 (('partition** 'YES ?p ?x ?xs ?yes ?nos) => ^(partition* ,p ,xs (,x . ,yes) ,nos))
 (('partition** 'NO  ?p ?x ?xs ?yes ?nos) => ^(partition* ,p ,xs ,yes (,x . ,nos)))

 (('any ?p ()        ) => 'NO)
 (('any ?p (?x . ?xs)) => ^(any* ,^(,p ,x) ,p ,xs))
 (('any* 'YES  _  _ ) => 'YES)
 (('any* 'NO  ?p ?xs) => ^(any ,p ,xs))

 (('every ?p ()) 'YES)
 (('every ?p (?x . ?xs)) => ^(every* ,^(,p ,x) ,p ,xs))
 (('every* 'NO   _  _ ) => 'NO)
 (('every* 'YES ?p ?xs) => ^(every ,p ,xs))

 ;(- only for testing... -)
 (('NUM? #n) => 'YES)
 (('NUM?  _) => 'NO)
 (('MAYBE-SQ #n) => (* n n))
 (('MAYBE-SQ  _) => 'NO)
)
