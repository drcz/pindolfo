(match? ('apd () ?ys) (apd () (a s d)))

(run-program (apd (q w e) (a s d))
               ( (('apd () ?ys) => ys)
                 (('apd (?x . ?xs) ?ys) => `(,x . ,^(apd ,xs ,ys))) ))

(run-program (rev (q w e a s d))
             ( (('rev ?xs) => ^(rev ,xs ()))
               (('rev () ?rs) => rs)
               (('rev (?x . ?xs) ?rs) => ^(rev ,xs (,x . ,rs))) ))

(run-program (apd (q w e) (a s d))
             ( (('fold-r ?op ?e ()        ) => e)
               (('fold-r ?op ?e (?x . ?xs)) => ^(,op ,x ,^(fold-r ,op ,e ,xs)))
               (('cons ?h ?t) => `(,h . ,t))
               (('apd ?xs ?ys) => ^(fold-r cons ,ys ,xs))
               ((('cons*f.hd ?f) ?h ?t) => ^(cons ,(rec (,f ,h)) ,t))
               (('map ?f ?xs) => ^(fold-r (cons*f.hd ,f) () ,xs))
               (('dup ?x) => `(,x . ,x))
               (('dbl ?xs) => ^(apd ,xs ,xs)) ))

(run-program (map dbl ((1 2 3) (6 9)))
             ( (('fold-r ?op ?e ()        ) => e)
               (('fold-r ?op ?e (?x . ?xs)) => ^(,op ,x ,^(fold-r ,op ,e ,xs)))
               (('cons ?h ?t) => `(,h . ,t))
               (('apd ?xs ?ys) => ^(fold-r cons ,ys ,xs))
               ((('cons*f.hd ?f) ?h ?t) => ^(cons ,(rec (,f ,h)) ,t))
               (('map ?f ?xs) => ^(fold-r (cons*f.hd ,f) () ,xs))
               (('dup ?x) => `(,x . ,x))
               (('dbl ?xs) => ^(apd ,xs ,xs)) ))

(run-program (map dup (- 0 9 v (o)))
             ( (('fold-r ?op ?e ()        ) => e)
               (('fold-r ?op ?e (?x . ?xs)) => ^(,op ,x ,^(fold-r ,op ,e ,xs)))
               (('cons ?h ?t) => `(,h . ,t))
               (('apd ?xs ?ys) => ^(fold-r cons ,ys ,xs))
               ((('cons*f.hd ?f) ?h ?t) => ^(cons ,(rec (,f ,h)) ,t))
               (('map ?f ?xs) => ^(fold-r (cons*f.hd ,f) () ,xs))
               (('dup ?x) => `(,x . ,x))
               (('dbl ?xs) => ^(apd ,xs ,xs)) ))
